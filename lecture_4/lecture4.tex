% ultima cosa \section{Example of forensic engagements}
\chapter{Acquisition}
    Forensics was born in the USA, it borders with law so it was developed with US laws in mind.\\
    The legal system of USA and the EUs ones are extremely different, and so is the court approach:
    \begin{itemize}
        \item In the U.S. most of the cases are tried by juries of peers, the judge works to make the court work. In fact, the judge is the one to decide if evidece is admissible or not. If not admissible, that could not be talked about from jury and lawyers or taken into account. Admissibility of scientific evidece is completely based on the concept of \textbf{chain of custody}: \textit{tracking where the evidence was taken, who was in custody, where was it stored, who analyzed it, what was done to it}. If that is broken, evidence becomes inadmissible.
        \item In Italy is the judge the one who takes the decision. The jury exists only in Corte d'Assise and it is made by people extracted from a certain set. Is the judge to evaluate the admissibility of the evidence, it is inadmissible only if it was taken in violation of laws.
    \end{itemize}
    By the way, the Counsil of Europe has an international law agreement called \textbf{Convention of Budapest on cybercrime}, it was written in 1999, and was incorporated in the Italian law in 2008. Also international standards from ISO/IEC can be applied.
\section{Brittleness of digital evidence}
    Digital evidence is \textbf{brittle}\footnote{fragile}, it is because if it is modified there is no way to tell. In other words, it is not \textbf{tamper evident}\footnote{non mostra segni di manomissione anche se manomessa}. This means that there is no way to say if the chain of custody was violated.\\
    Digital evidence can also be fake created:
    \begin{itemize}
        \item By changing for example the clock of a computer, it is possible to create a fake file which was modified in a different time, and there is no way to figure out if that happened.
    \end{itemize}
    We need an entire process of acquisition to create ways to make digital evidence as far as possible tamper evident, there is a need to ensure:
    \begin{itemize}
        \item Legal compliance: evidence must comply with the laws.
        \item Ethical behavior from all parties: even the police can act unhetical
        \item Detection of errors in good faith 
        \item Detection of natural decay
    \end{itemize}
\section{The usage of hashes in digital forensics}
    Hash function are used to record the state of an object at a given step of acquisiton. It is constantly checked to ensure authenticity and non-tampered state of that at any further phase of acquisition. They are used to \textit{"freeze"} the crime scene.
    \begin{itemize}
        \item We don't know what happened before that first step
        \item We can only tell if something has been tampered, but not what has been tampered. We also cannot restore data if tampered.
        \item Hashes are used to prove that something has been modified, but cannot tell what.
    \end{itemize}   
    Since evidence is going to be stored on a certain media, hashes must be put in another place \textit{(e.g. writing them on a physical register is the most frequent, or use digital signatures)}.
\section{Hardware and software for acquisition}
    \begin{itemize}
        \item Hardware:
        \begin{itemize}
            \item Removable HD enclosures or connectors with different plugs
            \item Write blocker
            \item External disks 
            \item USB, firewire, SATA, e-SATA controllers if possible
        \end{itemize}
        \item Linux: extensive native file system support, ease of accessing drives and partitions without mounting them
    \end{itemize}
\section{Bitstream images}
    What we want to acquire, if possible, is a \textbf{bitstream image}, a bit-by-bit clone of the original evidence media. The main reason is because if we only copy the allocated content we potentially lose information stored in the unallocated part of the disk. This is called a \textbf{forensic clone} or clone copy or image of the disk.
    %honorable mention per il piccione che Ã¨ entrato in aula
\section{Basic procedure of acquisition}
    \begin{itemize}
        \item Disconnect the media from the original system, if possible
        \item Connect the source media to the analysis station, if possible with a write blocker 
        \item Compute the hash of the source:
        \begin{itemize}
            \item Linux: \textit{\#dd if=/dev/sda conv=noerror,sync | sha256sum}
            \item conv=noerror means \textit{"keep going even if the system generated some errors"}
        \end{itemize}
        \item Copy the source:
        \begin{itemize}
            \item Linux:
            \item \textit{\#dd if=/dev/sda of=/tmp/acquisition.img conv=noerror,sync}
        \end{itemize}
        \item Compute the hashes of the source and the clone
        \begin{itemize}
            \item Linux: \textit{\#dd if=/dev/sda conv=noerror,sync | sha256sum}
            \item \textit{\#sha256sum /tmp/acquisition.img}
        \end{itemize}
        \item Compare the three hashes
    \end{itemize}
    If the hashes are different, it means that the copy didn't happened correctly or that you tampered with the drive, or that some damaged block read broke it, or that some damaged block reads everytime something different \dots \\
    It could be also good to compute MD5 and SHA-1 hashes, for redundancy and backward compatibility.
    \subsection{Challenges: time}
        A typical hard drive capacity today is 1TB. Transfer speeds are in the order of 600MB/s \textit{(SATA 3)}, but mechanical drives reach an average of 80MB/s \textit{(SSDs are actually fast as SATA3)}, USB connectors are up to 100MB/s.\\
        This means that for a 1TB drive you can expect to wait several hours to complete a copy or to run a hash. Tools like \textbf{embedded duplicators} or software like dcfldd can make this run in parallel to save time.
    \subsection{Challenges: size}
        File systems limit to 4TB mostly for the size of a file. If a drive is larger, it has to be spliced in more files.\\
        Space is also needed to keep data for all the devices used in an investigation, which can be in the order of the hundreds of terabytes, that's why NAS or SAN systems are common in forensic shops.\\
        Sometimes it can be also useful to move images across a network, for exaple by using netcat to listen for a stream generated by the computer which is taking the acquisition.
    \subsection{Challenges: encryption}
        Many machines use encryption. In some cases the key for decription is stored on the motherboard of the computer, and so the image became useless without the computer.
\section{Alternative procedures}
    \subsection{Alternative 1: booting from live distribution}
        Sometimes it is mandatory to work directly on the actual machine, because of systems with weird connectors, RAID devices or because of specific investigation constraints.\\
        In these cases it is possible to live-boot the system using a Linux distribution targeted for forensic analysis, like \textit{Tsurugi} or \textit{BackBox}\footnote{The reason why we use specific distribution, is because we do not want to overwrite linux swap partitions on the media}.\\
        This process has to be performed with great care, different systems have different ways to access the boot menu, and if by chance the original operating system is booted, it may be cause a loss of useful data.